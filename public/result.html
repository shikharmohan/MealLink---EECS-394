
<html>
  <head>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/parse/1.2.9/parse.min.js"></script>
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/ratchet/2.0.2/css/ratchet-theme-ios.css">
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/ratchet/2.0.2/css/ratchet-theme-ios.min.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/ratchet/2.0.2/css/ratchet.css">
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/ratchet/2.0.2/css/ratchet.min.css">
  
  <script src="http://cdnjs.cloudflare.com/ajax/libs/ratchet/2.0.2/js/ratchet.js"></script>
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/ratchet/2.0.2/js/ratchet.min.js"></script>
  

  <!-- jquery ui -->
  <script src="./jquery-ui-1.9.2.js"></script>
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

<!--initialize parse --> 
<script>
  Parse.initialize("oOL3TebXo0CCT8Mm8OWN72Dq7H1LwNvaGrSUmZ8I","kYZjxpsriEyaK25EhmKw8TfrU9je7ycVcTI6DC65")
</script>


<!-- 10.15 zexian zeng add this part to get user information -->
  <script>
    window.fbAsyncInit = function() {
       Parse.FacebookUtils.init({ // this line replaces FB.init({
         appId      : '1487754898165871', // Facebook App ID
         status     : false, // check Facebook Login status
         cookie     : true, // enable cookies to allow Parse to access the session
         xfbml      : true,
         version: "v2.1"
       });
       FB.getLoginStatus(function(response) {
         if (response.status === "connected") {
           var uid = response.authResponse.userID;
           var accessToken = response.authResponse.accessToken;
         }
         else {
           return;
         }
       });
     };
     (function(d, s, id){
       var js, fjs = d.getElementsByTagName(s)[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement(s); js.id = id;
       js.src = "//connect.facebook.net/en_US/sdk.js";
       fjs.parentNode.insertBefore(js, fjs);
     }(document, 'script', 'facebook-jssdk'));
  </script> 
<!-- 10.15 end of zexian zeng 's edition ' -->

<!-- 10.15 zexian zeng add this part to get user information -->
  <script>
    
  </script> 
<!-- 10.15 end of zexian zeng 's edition ' -->


    
    <!-- Makes your prototype chrome-less once bookmarked to your phone's home screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <style>
    .btnEat{
      margin-left: 120px;
      margin-bottom: 10px;
      margin-top: 10px;
    }
      .btnSubmit{
      margin-left: 140px;
      margin-bottom: 10px;
      margin-top: 10px;
    }
    .divHeight1{
      height:50px;
      border:0px;

    }
    img{
      width:30px;
      height:30px;

    }
    .liPadding{
      padding-right:0px;
    }
    </style>


    <title>My ParseApp site</title>
  </head>
  <body>
    
    <div class="segmented-control">
      <a href="#facebook_result" class="control-item active">Facebook</a>
      <a href="#linkedin_result" class="control-item">LinkedIn</a>
      <a href="#nearby_result" class="control-item">Nearby</a>
    </div>

    <div class="card">
    <ul id="facebook_result" class="control-content active table-view">
      <li class="table-view-cell">Fb <button class="btn">Button</button></li>
      <li class="table-view-cell">Item 2 <button class="btn btn-primary">Button</button></li>
      <li class="table-view-cell">Item 3 <button class="btn btn-positive">Button</button></li>
      <li class="table-view-cell">Item 4 <button class="btn btn-negative">Button</button></li>
    </ul>

    <ul id="linkedin_result" class="control-content table-view">
      <li class="table-view-cell">Linkedin <button class="btn">Button</button></li>
      <li class="table-view-cell">Item 2 <button class="btn btn-primary">Button</button></li>
      <li class="table-view-cell">Item 3 <button class="btn btn-positive">Button</button></li>
      <li class="table-view-cell">Item 4 <button class="btn btn-negative">Button</button></li>
    </ul>

    <ul id="nearby_result" class="control-content table-view">
      <li class="table-view-cell">Nearby <button class="btn">Button</button></li>
      <li class="table-view-cell">Item 2 <button class="btn btn-primary">Button</button></li>
      <li class="table-view-cell">Item 3 <button class="btn btn-positive">Button</button></li>
      <li class="table-view-cell">Item 4 <button class="btn btn-negative">Button</button></li>
    </ul>
  </div>

  

    <!-- 10/15 zexian add this to call function when paged loaded  -->
    <script type="text/javascript">
            function codeAddress() {
                
              if( Parse.User.current() ) {    //get current user 
                if( Parse.FacebookUtils.isLinked( Parse.User.current() ) ) {    //verify the user is connected, otherwise login again
                 //make a request to get facebook user's information
                  FB.api("/me", function(response){         
                  //get user information
                   var user_facebookID;      //the user's facebook_id 
                   var user_facebookName;
                    user_facebookID= response.id;
                   user_facebookName=response.name;

                  
                  //define a parse object, in order to get data
                  var EattingTime = Parse.Object.extend("EattingTime");
                  //obtain data from cloud
                  var query = new Parse.Query(EattingTime);

   //************************************edit the selection query here to select data from parse.com, the data is in the class of "EattingTime"
                  query.equalTo("facebook_id", user_facebookID);  
                  query.find({
                    success: function(results) {
                      alert("Successfully retrieved " + results.length + " scores.");
                      // Do something with the returned Parse.Object values
                      for (var i = 0; i < results.length; i++) { 
                        var object = results[i];
                        
 //*************         //handle the the user's eating time here, it contains the result qualifying the query abvoe, the user's geo information also contained here


                      }
                    },
                    error: function(error) {
                      alert("Error: " + error.code + " " + error.message);
                    }
                   });//end of query.find


                   //define a parse object, in order to get data
                   var FBFriendsMap = Parse.Object.extend("FBFriendsMap");
                   //obtain data from cloud
                   var query = new Parse.Query(FBFriendsMap);

 //************************************ edit the selection query here to select frineds from parse.com, the data is in the class of "FFBFrinedsMap"                  
                   query.equalTo("user_facebookID", user_facebookID);  //edit the selection query here
                   query.find({
                     success: function(results) {
                       alert("Successfully retrieved " + results.length + " scores.");
                       // Do something with the returned Parse.Object values
                       for (var i = 0; i < results.length; i++) { 
                         var object = results[i];
                         
  //*************         //handle the  user's frineds' facebook information here, it contains the data qualifying the query above


                       }
                     },
                     error: function(error) {
                       alert("Error: " + error.code + " " + error.message);
                     }
                    });//end of query.find     



                 });
                }
              }


            }
            window.onload = codeAddress;
    </script>
    <!-- 10/15 zexian add this to call function when paged loaded  -->

    <script>

      $(function() {
        $( "#tabs" ).tabs();
      });

      $('#SMStestbutton').click(function(){
        console.log("button works");
        var msg = "Hi " + "insert_name" + "! Let's meet for lunch at " + "insert_time" + ". Message me back at " + "insert_sender_phone_number" + "!" 
        var sendtonumber = "+1" + "9095699970"
        Parse.Cloud.run('sendSMS', { smsmessage: msg, number: sendtonumber}, {
          success: function(result) {
            // result is 'Hello world!'
            console.log("" + JSON.stringify(result));
          },
          error: function(error) {
            console.log("" + JSON.stringify(error));
          }
        });
      });

    </script>
   
  </body>
</html>
